<!--

    Copyright 2016 Digitising Scotland project:
    <http://digitisingscotland.cs.st-andrews.ac.uk/>

    This file is part of the module record_classification.

    record_classification is free software: you can redistribute it and/or modify it under the terms of the GNU General Public
    License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later
    version.

    record_classification is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied
    warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

    You should have received a copy of the GNU General Public License along with record_classification. If not, see
    <http://www.gnu.org/licenses/>.

-->
<!DOCTYPE html>
<html>
<head>
    <title>Tasks To Do</title>

    <meta charset="UTF-8">

    <!--no indexing by search engines-->
    <meta name="robots" content="noindex, nofollow">

    <!--no cache-->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>


    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="https://cdn.rawgit.com/jhollingworth/marked/master/lib/marked.js"></script>

</head>

<body>
<header style="padding: 10px; text-align: right">
    <input type="checkbox" id="hide_tick" checked="checked"> Hide completed tasks
</header>

<div id="faq" style="margin: 30px"></div>

<script type="text/javascript">


    function getCompletedTasks() {
        return $(".task-list-item input[checked]").parent();
    }

    function hideCompletedTasks() {
        getCompletedTasks().hide()
    }

    function showCompletedTasks() {
        $(".task-list-item input[checked]").parent().show()
    }

    function toggleCompletedTasksVisibility () {
        if ($('#hide_tick').is(":checked")) {
            hideCompletedTasks();
        } else {
            showCompletedTasks();
        }
        $('#hide_tick').val($(this).is(':checked'));
    }

    function disableTaskItemCheckbox() {
        $(".task-list-item input").attr("disabled", true);
    }
    $(document).ready(function () {

        $.ajax({
            type: 'GET',
            url: 'TODO.md'
        }).done(function (data) {
            $('#faq').html(marked(data));
            disableTaskItemCheckbox();
            toggleCompletedTasksVisibility();
        }).fail(function (error) {
            console.log(error);
            $('#faq').html('<div class="alert alert-danger" role="alert">' + error.status + ' ' + error.statusText + '</div>');
        });

        $('#hide_tick').change(toggleCompletedTasksVisibility);
    });
</script>
</body>
</html>
